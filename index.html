<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>539 歷史號碼分析工具</title>
<style>
  body { font-family: Arial, sans-serif; background: #0f172a; color: #f1f5f9; margin: 0; padding: 10px; }
  h1 { text-align: center; color: #38bdf8; }
  table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
  th, td { border: 1px solid #334155; padding: 6px; text-align: center; }
  th { background: #1e293b; }
  .stats { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
  .stat-card { background: #1e293b; padding: 10px; border-radius: 8px; width: 80px; text-align: center; }
  .hot { color: #f87171; font-weight: bold; }
  .cold { color: #60a5fa; font-weight: bold; }
  input, button { padding: 6px; margin: 5px; border-radius: 4px; border: none; }
  button { background: #38bdf8; color: #0f172a; font-weight: bold; cursor: pointer; }
</style>
</head>
<body>

<h1>539 歷史號碼分析工具</h1>

<input type="file" id="csvFile" accept=".csv">
<button onclick="loadCSV()">上傳 CSV 並分析</button>

<h2>歷史開獎號碼</h2>
<table id="historyTable">
  <thead>
    <tr>
      <th>日期</th>
      <th>號碼</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<h2>號碼出現次數</h2>
<div class="stats" id="numberStats"></div>

<h2>奇偶比例</h2>
<p id="oddEvenRatio"></p>

<script>
let historyData = [];

function loadCSV() {
  const file = document.getElementById('csvFile').files[0];
  if (!file) { alert('請選擇 CSV 檔案'); return; }
  const reader = new FileReader();
  reader.onload = function(e) {
    const text = e.target.result;
    parseCSV(text);
    analyze();
  };
  reader.readAsText(file);
}

function parseCSV(text) {
  historyData = [];
  const lines = text.trim().split('\n');
  for (let i = 1; i < lines.length; i++) { // 跳過標題
    const parts = lines[i].split(',');
    if (parts.length < 6) continue; // 確保有5個號碼
    const date = parts[0];
    const numbers = parts.slice(1,6).map(n => parseInt(n,10));
    historyData.push([date, numbers]);
  }
}

function analyze() {
  const tableBody = document.querySelector('#historyTable tbody');
  tableBody.innerHTML = '';

  let counts = Array(39).fill(0);
  let odd = 0, even = 0;

  historyData.forEach(([date, numbers]) => {
    tableBody.innerHTML += `<tr><td>${date}</td><td>${numbers.join(', ')}</td></tr>`;
    numbers.forEach(n => {
      counts[n-1]++;
      if (n % 2 === 0) even++; else odd++;
    });
  });

  const statsDiv = document.getElementById('numberStats');
  statsDiv.innerHTML = '';
  counts.forEach((c, idx) => {
    let cls = '';
    if (c === Math.max(...counts)) cls = 'hot';
    if (c === Math.min(...counts)) cls = 'cold';
    statsDiv.innerHTML += `<div class="stat-card ${cls}">${idx+1}<br>${c}</div>`;
  });

  document.getElementById('oddEvenRatio').innerText = `奇數: ${odd} 次，偶數: ${even} 次`;
}
</script>

</body>
</html>
